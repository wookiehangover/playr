/*
 * popcorn.js version cdef06e
 * http://popcornjs.org
 *
 * Copyright 2011, Mozilla Foundation
 * Licensed under the MIT license
 */

(function(r,q){function z(a){I.put.call(this,a)}function y(a){this.parent=a;this.byStart=[{start:-1,end:-1}];this.byEnd=[{start:-1,end:-1}];this.animating=[];this.endIndex=this.startIndex=0;this.previousUpdateTime=-1;Object.defineProperty(this,"count",{get:function(){return this.byStart.length}})}function A(a,b){var e=a.data.trackEvents.byStart,d=a.data.trackEvents.byEnd,g;b&&b._id&&a.data.history.push(b._id);b.start=c.util.toSeconds(b.start,a.options.framerate);b.end=c.util.toSeconds(b.end,a.options.framerate);
for(g=e.length-1;g>=0;g--)if(b.start>=e[g].start){e.splice(g+1,0,b);break}for(e=d.length-1;e>=0;e--)if(b.end>d[e].end){d.splice(e+1,0,b);break}g<=a.data.trackEvents.startIndex&&b.start<=a.data.trackEvents.previousUpdateTime&&a.data.trackEvents.startIndex++;e<=a.data.trackEvents.endIndex&&b.end<a.data.trackEvents.previousUpdateTime&&a.data.trackEvents.endIndex++;if(b.end>a.media.currentTime&&b.start<=a.media.currentTime){b._running=true;a.data.running[b._natives.type].push(b);if(!a.data.disabled[b._natives.type]){b._natives.start.call(a,
null,b);a.emit("trackstart",c.extend({},b,{plugin:b._natives.type,type:"trackstart",track:b}))}}}function B(a,b,e){var d,g,h,i;h=a.data.trackEvents.byStart.length;var l=0,m=0,n=[],j=[],f=[],k=[],p={};for(e=e||{};--h>-1;){d=a.data.trackEvents.byStart[l];g=a.data.trackEvents.byEnd[l];if(!d._id){n.push(d);j.push(g)}if(d._id){d._id!==b&&n.push(d);g._id!==b&&j.push(g);if(d._id===b){m=l;i=d}}l++}h=a.data.trackEvents.animating.length;l=0;if(h)for(;--h>-1;){d=a.data.trackEvents.animating[l];d._id||f.push(d);
d._id&&d._id!==b&&f.push(d);l++}m<=a.data.trackEvents.startIndex&&a.data.trackEvents.startIndex--;m<=a.data.trackEvents.endIndex&&a.data.trackEvents.endIndex--;a.data.trackEvents.byStart=n;a.data.trackEvents.byEnd=j;a.data.trackEvents.animating=f;h=a.data.history.length;for(l=0;l<h;l++)a.data.history[l]!==b&&k.push(a.data.history[l]);a.data.history=k;p.start=i.start;p.end=i.end;if(e&&e.previous){p.start=e.previous.start!==undefined?e.previous.start:p.start;p.end=e.previous.end!==undefined?e.previous.end:
p.end}if(p.end>a.media.currentTime&&p.start<=a.media.currentTime){b=a.data.running[i._natives.type];i._running=false;b.splice(b.indexOf(i),1);if(!a.data.disabled[i._natives.type]){i._natives.end.call(a,null,i);a.emit("trackend",c.extend({},i,{plugin:i._natives.type,type:"trackend",track:i}))}}}function J(a,b){return function(){if(c.plugin.debug)return a.apply(this,arguments);try{return a.apply(this,arguments)}catch(e){c.plugin.errors.push({plugin:b,thrown:e,source:a.toString()});this.emit("pluginerror",
c.plugin.errors)}}}if(q.addEventListener){var v=Array.prototype,C=Object.prototype,D=v.forEach,E=v.slice,u=C.hasOwnProperty,F=C.toString,K=r.Popcorn,x=[],G=false,w={events:{hash:{},apis:{}}},H=function(){return r.requestAnimationFrame||r.webkitRequestAnimationFrame||r.mozRequestAnimationFrame||r.oRequestAnimationFrame||r.msRequestAnimationFrame||function(a){r.setTimeout(a,16)}}(),I={put:function(a){Object.getOwnPropertyNames(a).forEach(function(b){this[b]=a[b]},this)}},c=function(a,b){return new c.p.init(a,
b||null)};c.version="cdef06e";c.isSupported=true;c.instances=[];c.p=c.prototype={init:function(a,b){var e,d=this;if(typeof a==="function")if(q.readyState==="complete")a(q,c);else{x.push(a);if(!G){G=true;var g=function(){q.removeEventListener("DOMContentLoaded",g,false);for(var l=0,m=x.length;l<m;l++)x[l].call(q,c);x=null};q.addEventListener("DOMContentLoaded",g,false)}}else{if(typeof a==="string")try{e=q.querySelector(a)}catch(h){throw Error("Popcorn.js Error: Invalid media element selector: "+a);
}this.media=e||a;e=this.media.nodeName&&this.media.nodeName.toLowerCase()||"video";this[e]=this.media;this.options=c.extend({},b)||{};this.id=this.options.id||c.guid(e);if(c.byId(this.id))throw Error("Popcorn.js Error: Cannot use duplicate ID ("+this.id+")");this.isDestroyed=false;this.data={running:{cue:[]},timeUpdate:c.nop,disabled:{},events:{},hooks:{},history:[],state:{volume:this.media.volume},trackRefs:{},trackEvents:new y(this)};c.instances.push(this);var i=function(){if(d.media.currentTime<
0)d.media.currentTime=0;d.media.removeEventListener("loadedmetadata",i,false);var l,m,n,j,f;l=d.media.duration;l=l!=l?Number.MAX_VALUE:l+1;c.addTrackEvent(d,{start:l,end:l});if(d.options.frameAnimation){d.data.timeUpdate=function(){c.timeUpdate(d,{});c.forEach(c.manifest,function(k,p){if(m=d.data.running[p]){j=m.length;for(var s=0;s<j;s++){n=m[s];(f=n._natives)&&f.frame&&f.frame.call(d,{},n,d.currentTime())}}});d.emit("timeupdate");!d.isDestroyed&&H(d.data.timeUpdate)};!d.isDestroyed&&H(d.data.timeUpdate)}else{d.data.timeUpdate=
function(k){c.timeUpdate(d,k)};d.isDestroyed||d.media.addEventListener("timeupdate",d.data.timeUpdate,false)}};Object.defineProperty(this,"error",{get:function(){return d.media.error}});d.media.readyState>=1?i():d.media.addEventListener("loadedmetadata",i,false);return this}}};c.p.init.prototype=c.p;c.byId=function(a){for(var b=c.instances,e=b.length,d=0;d<e;d++)if(b[d].id===a)return b[d];return null};c.forEach=function(a,b,e){if(!a||!b)return{};e=e||this;var d,g;if(D&&a.forEach===D)return a.forEach(b,
e);if(F.call(a)==="[object NodeList]"){d=0;for(g=a.length;d<g;d++)b.call(e,a[d],d,a);return a}for(d in a)u.call(a,d)&&b.call(e,a[d],d,a);return a};c.extend=function(a){var b=E.call(arguments,1);c.forEach(b,function(e){for(var d in e)a[d]=e[d]});return a};c.extend(c,{noConflict:function(a){if(a)r.Popcorn=K;return c},error:function(a){throw Error(a);},guid:function(a){c.guid.counter++;return(a?a:"")+(+new Date+c.guid.counter)},sizeOf:function(a){var b=0,e;for(e in a)b++;return b},isArray:Array.isArray||
function(a){return F.call(a)==="[object Array]"},nop:function(){},position:function(a){a=a.getBoundingClientRect();var b={},e=q.documentElement,d=q.body,g,h,i;g=e.clientTop||d.clientTop||0;h=e.clientLeft||d.clientLeft||0;i=r.pageYOffset&&e.scrollTop||d.scrollTop;e=r.pageXOffset&&e.scrollLeft||d.scrollLeft;g=Math.ceil(a.top+i-g);h=Math.ceil(a.left+e-h);for(var l in a)b[l]=Math.round(a[l]);return c.extend({},b,{top:g,left:h})},disable:function(a,b){if(!a.data.disabled[b]){a.data.disabled[b]=true;if(b in
c.registryByName&&a.data.running[b])for(var e=a.data.running[b].length-1,d;e>=0;e--){d=a.data.running[b][e];d._natives.end.call(a,null,d);a.emit("trackend",c.extend({},d,{plugin:d.type,type:"trackend"}))}return a}},enable:function(a,b){if(a.data.disabled[b]){a.data.disabled[b]=false;if(b in c.registryByName&&a.data.running[b])for(var e=a.data.running[b].length-1,d;e>=0;e--){d=a.data.running[b][e];d._natives.start.call(a,null,d);a.emit("trackstart",c.extend({},d,{plugin:d.type,type:"trackstart",track:d}))}return a}},
destroy:function(a){var b=a.data.events,e=a.data.trackEvents,d,g,h,i;for(g in b){d=b[g];for(h in d)delete d[h];b[g]=null}for(i in c.registryByName)c.removePlugin(a,i);e.byStart.length=0;e.byEnd.length=0;if(!a.isDestroyed){a.data.timeUpdate&&a.media.removeEventListener("timeupdate",a.data.timeUpdate,false);a.isDestroyed=true}c.instances.splice(c.instances.indexOf(a),1)}});c.guid.counter=1;c.extend(c.p,function(){var a={};c.forEach("load play pause currentTime playbackRate volume duration preload playbackRate autoplay loop controls muted buffered readyState seeking paused played seekable ended".split(/\s+/g),
function(b){a[b]=function(e){var d;if(typeof this.media[b]==="function"){if(e!=null&&/play|pause/.test(b))this.media.currentTime=c.util.toSeconds(e);this.media[b]();return this}if(e!=null){d=this.media[b];this.media[b]=e;d!==e&&this.emit("attrchange",{attribute:b,previousValue:d,currentValue:e});return this}return this.media[b]}});return a}());c.forEach("enable disable".split(" "),function(a){c.p[a]=function(b){return c[a](this,b)}});c.extend(c.p,{roundTime:function(){return Math.round(this.media.currentTime)},
exec:function(a,b,e){var d=arguments.length,g="trackadded",h,i;try{i=c.util.toSeconds(a)}catch(l){}if(typeof i==="number")a=i;if(typeof a==="number"&&d===2){e=b;b=a;a=c.guid("cue")}else if(d===1)b=-1;else if(h=this.getTrackEvent(a)){c.removeTrackEvent(this,a);g="cuechange";if(typeof a==="string"&&d===2){if(typeof b==="number")e=h._natives.start;if(typeof b==="function"){e=b;b=h.start}}}else if(d>=2){if(typeof b==="string"){try{i=c.util.toSeconds(b)}catch(m){}b=i}if(typeof b==="number")e=e||c.nop();
if(typeof b==="function"){e=b;b=-1}}d={id:a,start:b,end:b+1,_running:false,_natives:{start:e||c.nop,end:c.nop,type:"cue"}};c.addTrackEvent(this,d);if(g==="cuechange")this.emit(g,c.extend({},d,{id:a,type:g,previousValue:{time:h.start,fn:h._natives.start},currentValue:{time:b,fn:e||c.nop},track:h}));return this},mute:function(a){a=a==null||a===true?"muted":"unmuted";if(a==="unmuted"){this.media.muted=false;this.media.volume=this.data.state.volume}if(a==="muted"){this.data.state.volume=this.media.volume;
this.media.muted=true}this.emit(a);return this},unmute:function(a){return this.mute(a==null?false:!a)},position:function(){return c.position(this.media)},toggle:function(a){return c[this.data.disabled[a]?"enable":"disable"](this,a)},defaults:function(a,b){if(c.isArray(a)){c.forEach(a,function(e){for(var d in e)this.defaults(d,e[d])},this);return this}if(!this.options.defaults)this.options.defaults={};this.options.defaults[a]||(this.options.defaults[a]={});c.extend(this.options.defaults[a],b);return this}});
c.Events={UIEvents:"blur focus focusin focusout load resize scroll unload",MouseEvents:"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave click dblclick",Events:"loadstart progress suspend emptied stalled play pause error loadedmetadata loadeddata waiting playing canplay canplaythrough seeking seeked timeupdate ended ratechange durationchange volumechange"};c.Events.Natives=c.Events.UIEvents+" "+c.Events.MouseEvents+" "+c.Events.Events;w.events.apiTypes=["UIEvents","MouseEvents",
"Events"];(function(a,b){for(var e=w.events.apiTypes,d=a.Natives.split(/\s+/g),g=0,h=d.length;g<h;g++)b.hash[d[g]]=true;e.forEach(function(i){b.apis[i]={};for(var l=a[i].split(/\s+/g),m=l.length,n=0;n<m;n++)b.apis[i][l[n]]=true})})(c.Events,w.events);c.events={isNative:function(a){return!!w.events.hash[a]},getInterface:function(a){if(!c.events.isNative(a))return false;var b=w.events,e=b.apiTypes;b=b.apis;for(var d=0,g=e.length,h,i;d<g;d++){i=e[d];if(b[i][a]){h=i;break}}return h},all:c.Events.Natives.split(/\s+/g),
fn:{trigger:function(a,b){var e,d=this.data.events[a];if(d){if(e=c.events.getInterface(a)){e=q.createEvent(e);e.initEvent(a,true,true,r,1);this.media.dispatchEvent(e);return this}for(e=d.slice();e.length;)e.shift().call(this,b)}return this},listen:function(a,b){var e=this,d=true,g=c.events.hooks[a],h,i;if(typeof b!=="function")throw Error("Popcorn.js Error: Listener is not a function");if(!this.data.events[a]){this.data.events[a]=[];d=false}if(g){g.add&&g.add.call(this,{},b);if(g.bind)a=g.bind;if(g.handler){i=
b;b=function(l){g.handler.call(e,l,i)}}d=true;if(!this.data.events[a]){this.data.events[a]=[];d=false}}this.data.events[a].push(b);!d&&c.events.all.indexOf(a)>-1&&this.media.addEventListener(a,function(l){if(e.data.events[a])for(h=e.data.events[a].slice();h.length;)h.shift().call(e,l)},false);return this},unlisten:function(a,b){var e,d=this.data.events[a];if(d){if(typeof b==="string"){for(e=0;e<d.length;e++)d[e].name===b&&d.splice(e--,1);return this}else if(typeof b==="function"){for(;e!==-1;){e=
d.indexOf(b);e!==-1&&d.splice(e,1)}return this}this.data.events[a]=null;return this}}},hooks:{canplayall:{bind:"canplaythrough",add:function(a,b){var e=false;if(this.media.readyState){setTimeout(function(){b.call(this,a)}.bind(this),0);e=true}this.data.hooks.canplayall={fired:e}},handler:function(a,b){if(!this.data.hooks.canplayall.fired){b.call(this,a);this.data.hooks.canplayall.fired=true}}}}};c.forEach([["trigger","emit"],["listen","on"],["unlisten","off"]],function(a){c.p[a[0]]=c.p[a[1]]=c.events.fn[a[0]]});
y.prototype.remove=function(a){this.where(a).forEach(function(b){this.removeTrackEvent(b._id)},this.parent);return this};y.prototype.where=function(a){return(this.parent.getTrackEvents()||[]).filter(function(b){var e,d;if(!a)return true;for(e in a){d=a[e];if(b[e]&&b[e]===d||b._natives[e]&&b._natives[e]===d)return true}return false})};c.addTrackEvent=function(a,b){var e=false;if(!(b instanceof z)){b=new z(b);e=true}if(b&&b._natives&&b._natives.type&&a.options.defaults&&a.options.defaults[b._natives.type])b=
c.extend({},a.options.defaults[b._natives.type],b);if(b._natives){b._id=b.id||b._id||c.guid(b._natives.type);if(b._natives._setup){b._natives._setup.call(a,b);a.emit("tracksetup",c.extend({},b,{plugin:b._natives.type,type:"tracksetup",track:b}))}}A(a,b);this.timeUpdate(a,null,true);b._id&&c.addTrackEvent.ref(a,b);if(e)a.emit("trackadded",c.extend({},b,b._natives?{plugin:b._natives.type}:{},{type:"trackadded",track:b}))};c.addTrackEvent.ref=function(a,b){a.data.trackRefs[b._id]=b;return a};c.removeTrackEvent=
function(a,b,e){var d=a.getTrackEvent(b);e=e||{};if(d){d._natives._teardown&&d._natives._teardown.call(a,d);B(a,b,e);c.removeTrackEvent.ref(a,b);d._natives&&a.emit("trackremoved",c.extend({},d,{plugin:d._natives.type,type:"trackremoved",track:d}))}};c.removeTrackEvent.ref=function(a,b){delete a.data.trackRefs[b];return a};c.getTrackEvents=function(a){var b=[];a=a.data.trackEvents.byStart;for(var e=a.length,d=0,g;d<e;d++){g=a[d];g._id&&b.push(g)}return b};c.getTrackEvents.ref=function(a){return a.data.trackRefs};
c.getTrackEvent=function(a,b){return a.data.trackRefs[b]};c.getTrackEvent.ref=function(a,b){return a.data.trackRefs[b]};c.getLastTrackEventId=function(a){return a.data.history[a.data.history.length-1]};c.timeUpdate=function(a,b){var e=a.media.currentTime,d=a.data.trackEvents.previousUpdateTime,g=a.data.trackEvents,h=g.endIndex,i=g.startIndex,l=g.byStart.length,m=g.byEnd.length,n=c.registryByName,j,f,k;if(d<=e){for(;g.byEnd[h]&&g.byEnd[h].end<=e;){j=g.byEnd[h];f=(d=j._natives)&&d.type;if(!d||n[f]||
a[f]){if(j._running===true){j._running=false;k=a.data.running[f];k.splice(k.indexOf(j),1);if(!a.data.disabled[f]){d.end.call(a,b,j);a.emit("trackend",c.extend({},j,{plugin:f,type:"trackend",track:j}))}}h++}else{c.removeTrackEvent(a,j._id);return}}for(;g.byStart[i]&&g.byStart[i].start<=e;){j=g.byStart[i];f=(d=j._natives)&&d.type;if(!d||n[f]||a[f]){if(j.end>e&&j._running===false){j._running=true;a.data.running[f].push(j);if(!a.data.disabled[f]){d.start.call(a,b,j);a.emit("trackstart",c.extend({},j,
{plugin:f,type:"trackstart",track:j}))}}i++}else{c.removeTrackEvent(a,j._id);return}}}else if(d>e){for(;g.byStart[i]&&g.byStart[i].start>e;){j=g.byStart[i];f=(d=j._natives)&&d.type;if(!d||n[f]||a[f]){if(j._running===true){j._running=false;k=a.data.running[f];k.splice(k.indexOf(j),1);if(!a.data.disabled[f]){d.end.call(a,b,j);a.emit("trackend",c.extend({},j,{plugin:f,type:"trackend",track:j}))}}i--}else{c.removeTrackEvent(a,j._id);return}}for(;g.byEnd[h]&&g.byEnd[h].end>e;){j=g.byEnd[h];f=(d=j._natives)&&
d.type;if(!d||n[f]||a[f]){if(j.start<=e&&j._running===false){j._running=true;a.data.running[f].push(j);if(!a.data.disabled[f]){d.start.call(a,b,j);a.emit("trackstart",c.extend({},j,{plugin:f,type:"trackstart",track:j}))}}h--}else{c.removeTrackEvent(a,j._id);return}}}g.endIndex=h;g.startIndex=i;g.previousUpdateTime=e;g.byStart.length<l&&g.startIndex--;g.byEnd.length<m&&g.endIndex--};c.extend(c.p,{getTrackEvents:function(){return c.getTrackEvents.call(null,this)},getTrackEvent:function(a){return c.getTrackEvent.call(null,
this,a)},getLastTrackEventId:function(){return c.getLastTrackEventId.call(null,this)},removeTrackEvent:function(a){c.removeTrackEvent.call(null,this,a);return this},removePlugin:function(a){c.removePlugin.call(null,this,a);return this},timeUpdate:function(a){c.timeUpdate.call(null,this,a);return this},destroy:function(){c.destroy.call(null,this);return this}});c.manifest={};c.registry=[];c.registryByName={};c.plugin=function(a,b,e){if(c.protect.natives.indexOf(a.toLowerCase())>=0)c.error("'"+a+"' is a protected function name");
else{var d=typeof b==="function",g=["start","end","type","manifest"],h=["_setup","_teardown","start","end","frame"],i={},l=function(j,f){j=j||c.nop;f=f||c.nop;return function(){j.apply(this,arguments);f.apply(this,arguments)}};c.manifest[a]=e=e||b.manifest||{};h.forEach(function(j){b[j]=J(b[j]||c.nop,a)});var m=function(j,f){if(!f)return this;if(f.ranges&&c.isArray(f.ranges)){c.forEach(f.ranges,function(o){o=c.extend({},f,o);delete o.ranges;this[a](o)},this);return this}var k=f._natives={},p="",s;
c.extend(k,j);f._natives.type=f._natives.plugin=a;f._running=false;k.start=k.start||k["in"];k.end=k.end||k.out;if(f.once)k.end=l(k.end,function(){this.removeTrackEvent(f._id)});k._teardown=l(function(){var o=E.call(arguments),t=this.data.running[k.type];o.unshift(null);o[1]._running&&t.splice(t.indexOf(f),1)&&k.end.apply(this,o);this.emit("trackend",c.extend({},f,{plugin:k.type,type:"trackend",track:c.getTrackEvent(this,f.id||f._id)}))},k._teardown);k._teardown=l(k._teardown,function(){this.emit("trackteardown",
c.extend({},f,{plugin:a,type:"trackteardown",track:c.getTrackEvent(this,f.id||f._id)}))});f.compose=f.compose||[];if(typeof f.compose==="string")f.compose=f.compose.split(" ");f.effect=f.effect||[];if(typeof f.effect==="string")f.effect=f.effect.split(" ");f.compose=f.compose.concat(f.effect);f.compose.forEach(function(o){p=c.compositions[o]||{};h.forEach(function(t){k[t]=l(k[t],p[t])})});f._natives.manifest=e;if(!("start"in f))f.start=f["in"]||0;if(!f.end&&f.end!==0)f.end=f.out||Number.MAX_VALUE;
if(!u.call(f,"toString"))f.toString=function(){var o=["start: "+f.start,"end: "+f.end,"id: "+(f.id||f._id)];f.target!=null&&o.push("target: "+f.target);return a+" ( "+o.join(", ")+" )"};if(!f.target){s="options"in e&&e.options;f.target=s&&"target"in s&&s.target}if(!f._id&&f._natives)f._id=c.guid(f._natives.type);c.addTrackEvent(this,f);c.forEach(j,function(o,t){g.indexOf(t)===-1&&this.on(t,o)},this);return this};c.p[a]=i[a]=function(j,f){var k,p;if(j&&!f)f=j;else if(k=this.getTrackEvent(j)){p=f;var s=
{},o;for(o in k)if(u.call(p,o)&&u.call(k,o))s[o]=k[o];if(k._natives._update){B(this,k._id);if(u.call(f,"start"))k.start=f.start;if(u.call(f,"end"))k.end=f.end;d&&b.call(this,k);k._natives._update.call(this,k,f);A(this,k)}else{c.extend(k,f);c.removeTrackEvent(this,j,{previous:s});d?m.call(this,b.call(this,k),k):c.addTrackEvent(this,k);this.emit("trackchange",{id:k.id,type:"trackchange",previousValue:s,currentValue:k,track:k});return this}k._natives.type!=="cue"&&this.emit("trackchange",{id:k.id,type:"trackchange",
previousValue:s,currentValue:p,track:k});return this}else f.id=j;this.data.running[a]=this.data.running[a]||[];k=c.extend({},this.options.defaults&&this.options.defaults[a]||{},f);m.call(this,d?b.call(this,k):b,k);return this};e&&c.extend(b,{manifest:e});var n={fn:i[a],definition:b,base:b,parents:[],name:a};c.registry.push(c.extend(i,n,{type:a}));c.registryByName[a]=n;return i}};c.plugin.errors=[];c.plugin.debug=c.version==="cdef06e";c.removePlugin=function(a,b){if(!b){b=a;a=c.p;if(c.protect.natives.indexOf(b.toLowerCase())>=
0){c.error("'"+b+"' is a protected function name");return}var e=c.registry.length,d;for(d=0;d<e;d++)if(c.registry[d].name===b){c.registry.splice(d,1);delete c.registryByName[b];delete c.manifest[b];delete a[b];return}}e=a.data.trackEvents.byStart;d=a.data.trackEvents.byEnd;var g=a.data.trackEvents.animating,h,i;h=0;for(i=e.length;h<i;h++){if(e[h]&&e[h]._natives&&e[h]._natives.type===b){e[h]._natives._teardown&&e[h]._natives._teardown.call(a,e[h]);e.splice(h,1);h--;i--;if(a.data.trackEvents.startIndex<=
h){a.data.trackEvents.startIndex--;a.data.trackEvents.endIndex--}}d[h]&&d[h]._natives&&d[h]._natives.type===b&&d.splice(h,1)}h=0;for(i=g.length;h<i;h++)if(g[h]&&g[h]._natives&&g[h]._natives.type===b){g.splice(h,1);h--;i--}};c.compositions={};c.compose=function(a,b,e){c.manifest[a]=e||b.manifest||{};c.compositions[a]=b};c.plugin.effect=c.effect=c.compose;var L=/^(?:\.|#|\[)/;c.dom={debug:false,find:function(a,b){var e=null;b=b||q;if(a){if(!L.test(a)){e=q.getElementById(a);if(e!==null)return e}try{e=
b.querySelector(a)}catch(d){if(c.dom.debug)throw Error(d);}}return e}};var M=/\?/,N={url:"",data:"",dataType:"",success:c.nop,type:"GET",async:true,xhr:function(){return new r.XMLHttpRequest}};c.xhr=function(a){a.dataType=a.dataType&&a.dataType.toLowerCase()||null;if(a.dataType&&(a.dataType==="jsonp"||a.dataType==="script"))c.xhr.getJSONP(a.url,a.success,a.dataType==="script");else{a=c.extend({},N,a);a.ajax=a.xhr();if(a.ajax){if(a.type==="GET"&&a.data){a.url+=(M.test(a.url)?"&":"?")+a.data;a.data=
null}a.ajax.open(a.type,a.url,a.async);a.ajax.send(a.data||null);return c.xhr.httpData(a)}}};c.xhr.httpData=function(a){var b,e=null,d,g=null;a.ajax.onreadystatechange=function(){if(a.ajax.readyState===4){try{e=JSON.parse(a.ajax.responseText)}catch(h){}b={xml:a.ajax.responseXML,text:a.ajax.responseText,json:e};if(!b.xml||!b.xml.documentElement){b.xml=null;try{d=new DOMParser;g=d.parseFromString(a.ajax.responseText,"text/xml");if(!g.getElementsByTagName("parsererror").length)b.xml=g}catch(i){}}if(a.dataType)b=
b[a.dataType];a.success.call(a.ajax,b)}};return b};c.xhr.getJSONP=function(a,b,e){var d=q.head||q.getElementsByTagName("head")[0]||q.documentElement,g=q.createElement("script"),h=false,i=[];i=/(=)\?(?=&|$)|\?\?/;var l,m;if(!e){m=a.match(/(callback=[^&]*)/);if(m!==null&&m.length){i=m[1].split("=")[1];if(i==="?")i="jsonp";l=c.guid(i);a=a.replace(/(callback=[^&]*)/,"callback="+l)}else{l=c.guid("jsonp");if(i.test(a))a=a.replace(i,"$1"+l);i=a.split(/\?(.+)?/);a=i[0]+"?";if(i[1])a+=i[1]+"&";a+="callback="+
l}window[l]=function(n){b&&b(n);h=true}}g.addEventListener("load",function(){e&&b&&b();h&&delete window[l];d.removeChild(g)},false);g.src=a;d.insertBefore(g,d.firstChild)};c.getJSONP=c.xhr.getJSONP;c.getScript=c.xhr.getScript=function(a,b){return c.xhr.getJSONP(a,b,true)};c.util={toSeconds:function(a,b){var e=/^([0-9]+:){0,2}[0-9]+([.;][0-9]+)?$/,d,g,h;if(typeof a==="number")return a;typeof a==="string"&&!e.test(a)&&c.error("Invalid time format");e=a.split(":");d=e.length-1;g=e[d];if(g.indexOf(";")>
-1){g=g.split(";");h=0;if(b&&typeof b==="number")h=parseFloat(g[1],10)/b;e[d]=parseInt(g[0],10)+h}d=e[0];return{1:parseFloat(d,10),2:parseInt(d,10)*60+parseFloat(e[1],10),3:parseInt(d,10)*3600+parseInt(e[1],10)*60+parseFloat(e[2],10)}[e.length||1]}};c.p.cue=c.p.exec;c.protect={natives:function(a){return Object.keys?Object.keys(a):function(b){var e,d=[];for(e in b)u.call(b,e)&&d.push(e);return d}(a)}(c.p).map(function(a){return a.toLowerCase()})};c.forEach({listen:"on",unlisten:"off",trigger:"emit",
exec:"cue"},function(a,b){var e=c.p[b];c.p[b]=function(){if(typeof console!=="undefined"&&console.warn){console.warn("Deprecated method '"+b+"', "+(a==null?"do not use.":"use '"+a+"' instead."));c.p[b]=e}return c.p[a].apply(this,[].slice.call(arguments))}});r.Popcorn=c}else{r.Popcorn={isSupported:false};for(v="byId forEach extend effects error guid sizeOf isArray nop position disable enable destroyaddTrackEvent removeTrackEvent getTrackEvents getTrackEvent getLastTrackEventId timeUpdate plugin removePlugin compose effect xhr getJSONP getScript".split(/\s+/);v.length;)r.Popcorn[v.shift()]=
function(){}}})(window,window.document);
