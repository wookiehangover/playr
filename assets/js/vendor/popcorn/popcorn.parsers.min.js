(function(m){m.parser("parseJSON","JSON",function(k){var l={title:"",remote:"",data:[]};m.forEach(k.data,function(e){l.data.push(e)});return l})})(Popcorn);(function(m){m.parser("parseSBV",function(k){var l={title:"",remote:"",data:[]},e=[],c=0,h=0,g=function(j){j=j.split(":");var n=j.length-1,o;try{o=parseInt(j[n-1],10)*60+parseFloat(j[n],10);if(n===2)o+=parseInt(j[0],10)*3600}catch(p){throw"Bad cue";}return o},b=function(j,n){var o={};o[j]=n;return o};k=k.text.split(/(?:\r\n|\r|\n)/gm);for(h=k.length;c<h;){var f={},i=[],a=k[c++].split(",");try{f.start=g(a[0]);for(f.end=g(a[1]);c<h&&k[c];)i.push(k[c++]);f.text=i.join("<br />");e.push(b("subtitle",f))}catch(d){for(;c<
h&&k[c];)c++}for(;c<h&&!k[c];)c++}l.data=e;return l})})(Popcorn);(function(m){function k(e,c){var h={};h[e]=c;return h}function l(e){e=e.split(":");try{var c=e[2].split(",");if(c.length===1)c=e[2].split(".");return parseFloat(e[0],10)*3600+parseFloat(e[1],10)*60+parseFloat(c[0],10)+parseFloat(c[1],10)/1E3}catch(h){return 0}}m.parser("parseSRT",function(e){var c={title:"",remote:"",data:[]},h=[],g=0,b=0,f,i,a,d;e=e.text.split(/(?:\r\n|\r|\n)/gm);for(g=e.length-1;g>=0&&!e[g];)g--;a=g+1;for(g=0;g<a;g++){d={};i=[];d.id=parseInt(e[g++],10);f=e[g++].split(/[\t ]*--\>[\t ]*/);
d.start=l(f[0]);b=f[1].indexOf(" ");if(b!==-1)f[1]=f[1].substr(0,b);for(d.end=l(f[1]);g<a&&e[g];)i.push(e[g++]);d.text=i.join("\\N").replace(/\{(\\[\w]+\(?([\w\d]+,?)+\)?)+\}/gi,"");d.text=d.text.replace(/</g,"&lt;").replace(/>/g,"&gt;");d.text=d.text.replace(/&lt;(\/?(font|b|u|i|s))((\s+(\w|\w[\w\-]*\w)(\s*=\s*(?:\".*?\"|'.*?'|[^'\">\s]+))?)+\s*|\s*)(\/?)&gt;/gi,"<$1$3$7>");d.text=d.text.replace(/\\N/gi,"<br />");h.push(k("subtitle",d))}c.data=h;return c})})(Popcorn);(function(m){function k(c,h){var g=c.substr(10).split(","),b;b={start:l(g[h.start]),end:l(g[h.end])};if(b.start===-1||b.end===-1)throw"Invalid time";var f=j.call(a,/\{(\\[\w]+\(?([\w\d]+,?)+\)?)+\}/gi,""),i=f.replace,a;a=g.length;j=[];for(var d=h.text;d<a;d++)j.push(g[d]);a=j.join(",");var j=a.replace;b.text=i.call(f,/\\N/gi,"<br />");return b}function l(c){var h=c.split(":");if(c.length!==10||h.length<3)return-1;return parseInt(h[0],10)*3600+parseInt(h[1],10)*60+parseFloat(h[2],10)}function e(c,
h){var g={};g[c]=h;return g}m.parser("parseSSA",function(c){var h={title:"",remote:"",data:[]},g=[],b=0,f;c=c.text.split(/(?:\r\n|\r|\n)/gm);for(f=c.length;b<f&&c[b]!=="[Events]";)b++;var i=c[++b].substr(8).split(", "),a={},d,j;j=0;for(d=i.length;j<d;j++)if(i[j]==="Start")a.start=j;else if(i[j]==="End")a.end=j;else if(i[j]==="Text")a.text=j;for(;++b<f&&c[b]&&c[b][0]!=="[";)try{g.push(e("subtitle",k(c[b],a)))}catch(n){}h.data=g;return h})})(Popcorn);(function(m){function k(b,f,i){var a=b.firstChild;b=l(b,i);i=[];for(var d;a;){if(a.nodeType===1)if(a.nodeName==="p")i.push(e(a,f,b));else if(a.nodeName==="div"){d=c(a.getAttribute("begin"));if(d<0)d=f;i.push.apply(i,k(a,d,b))}a=a.nextSibling}return i}function l(b,f){var i=b.getAttribute("region");return i!==null?i:f||""}function e(b,f,i){var a={};a.text=(b.textContent||b.text).replace(h,"").replace(g,"<br />");a.id=b.getAttribute("xml:id")||b.getAttribute("id");a.start=c(b.getAttribute("begin"),f);
a.end=c(b.getAttribute("end"),f);a.target=l(b,i);if(a.end<0){a.end=c(b.getAttribute("duration"),0);if(a.end>=0)a.end+=a.start;else a.end=Number.MAX_VALUE}return{subtitle:a}}function c(b,f){var i;if(!b)return-1;try{return m.util.toSeconds(b)}catch(a){for(var d=b.length-1;d>=0&&b[d]<="9"&&b[d]>="0";)d--;i=d;d=parseFloat(b.substring(0,i));i=b.substring(i);return d*({h:3600,m:60,s:1,ms:0.0010}[i]||-1)+(f||0)}}var h=/^[\s]+|[\s]+$/gm,g=/(?:\r\n|\r|\n)/gm;m.parser("parseTTML",function(b){var f={title:"",
remote:"",data:[]};if(!b.xml||!b.xml.documentElement)return f;b=b.xml.documentElement.firstChild;if(!b)return f;for(;b.nodeName!=="body";)b=b.nextSibling;if(b)f.data=k(b,0);return f})})(Popcorn);(function(m){m.parser("parseTTXT",function(k){var l={title:"",remote:"",data:[]},e=function(f){f=f.split(":");var i=0;try{return parseFloat(f[0],10)*60*60+parseFloat(f[1],10)*60+parseFloat(f[2],10)}catch(a){i=0}return i},c=function(f,i){var a={};a[f]=i;return a};k=k.xml.lastChild.lastChild;for(var h=Number.MAX_VALUE,g=[];k;){if(k.nodeType===1&&k.nodeName==="TextSample"){var b={};b.start=e(k.getAttribute("sampleTime"));b.text=k.getAttribute("text");if(b.text){b.end=h-0.0010;g.push(c("subtitle",b))}h=
b.start}k=k.previousSibling}l.data=g.reverse();return l})})(Popcorn);(function(m){function k(e){var c=e.split(":");e=e.length;var h;if(e!==12&&e!==9)throw"Bad cue";e=c.length-1;try{h=parseInt(c[e-1],10)*60+parseFloat(c[e],10);if(e===2)h+=parseInt(c[0],10)*3600}catch(g){throw"Bad cue";}return h}function l(e,c){var h={};h[e]=c;return h}m.parser("parseVTT",function(e){var c={title:"",remote:"",data:[]},h=[],g=0,b=0,f,i;e=e.text.split(/(?:\r\n|\r|\n)/gm);b=e.length;if(b===0||e[0]!=="WEBVTT")return c;for(g++;g<b;){f=[];try{for(var a=g;a<b&&!e[a];)a++;g=a;var d=e[g++];a=
void 0;var j={};if(!d||d.indexOf("--\>")===-1)throw"Bad cue";a=d.replace(/--\>/," --\> ").split(/[\t ]+/);if(a.length<2)throw"Bad cue";j.id=d;j.start=k(a[0]);j.end=k(a[2]);for(i=j;g<b&&e[g];)f.push(e[g++]);i.text=f.join("<br />");h.push(l("subtitle",i))}catch(n){for(g=g;g<b&&e[g];)g++;g=g}}c.data=h;return c})})(Popcorn);(function(m){m.parser("parseXML","XML",function(k){var l={title:"",remote:"",data:[]},e={},c=function(a){a=a.split(":");if(a.length===1)return parseFloat(a[0],10);else if(a.length===2)return parseFloat(a[0],10)+parseFloat(a[1]/12,10);else if(a.length===3)return parseInt(a[0]*60,10)+parseFloat(a[1],10)+parseFloat(a[2]/12,10);else if(a.length===4)return parseInt(a[0]*3600,10)+parseInt(a[1]*60,10)+parseFloat(a[2],10)+parseFloat(a[3]/12,10)},h=function(a){for(var d={},j=0,n=a.length;j<n;j++){var o=a.item(j).nodeName,
p=a.item(j).nodeValue,r=e[p];if(o==="in")d.start=c(p);else if(o==="out")d.end=c(p);else if(o==="resourceid")for(var q in r){if(r.hasOwnProperty(q))if(!d[q]&&q!=="id")d[q]=r[q]}else d[o]=p}return d},g=function(a,d){var j={};j[a]=d;return j},b=function(a,d,j){var n={};m.extend(n,d,h(a.attributes),{text:a.textContent||a.text});d=a.childNodes;if(d.length<1||d.length===1&&d[0].nodeType===3)if(j)e[n.id]=n;else l.data.push(g(a.nodeName,n));else for(a=0;a<d.length;a++)d[a].nodeType===1&&b(d[a],n,j)};k=k.documentElement.childNodes;
for(var f=0,i=k.length;f<i;f++)if(k[f].nodeType===1)k[f].nodeName==="manifest"?b(k[f],{},true):b(k[f],{},false);return l})})(Popcorn);
